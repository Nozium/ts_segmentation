# st_segmentation における体動センサー限定でのデータ抽出アルゴリズムの評価について
## 判定するべき目的変数
- 人の在不在 を体動センサーから検出できるようにする

### 判定要件
- 精度検証要件
    - Jaccard係数 > 0.75  
![DiceAnd Jaccard](statics/image.png)
    - TP : 人がいると判定した時間帯に人がいる
    - FP : 人がいると判定した時間帯に人がいない
    - TN : 人がいないと判定した時間帯に人がいない
    - FN : 人がいないと判定した時間帯に人がいる
- 人の在不在の判定は、1s 単位で行う
- 判定の入力時間幅は、10sとする

## 正解データの作成
- 人の在不在について
    - ハンドアノテーションで、明確に人がいる時間帯といない時間帯を定義する(1s 単位)
        - awake == 1 は姿勢が不明のため全て除外対象とする
        - fileのdate subprefixはTMS側かどうかは確認依頼済み
    - ResNetベースで画像から人の在不在を判定し評価する
- 境界条件について
- 除外条件について

### 確認事項
- [x] 処理速度について比較対象にするか(しないとしても結果は残すか) > 記録だけ残す 1s / 10s / 30min
- [x] 人の在不在の判定は、1s 単位で行うが、判定の時間ズレはどの程度許容するか < 住友理工 < 10s
- [ ] {忘れた}
- [ ] アーチファクトの時間量はどの程度あるか < 住友理工*1min
- [ ] 住友理工のアルゴリズムより、良い / 悪いの評価をするか
- [ ] いつまでに結果を出すか : {未定}

## 留意事項
### GT不備が発生する条件　: カメラ画像がわで自動判定できない(54人分ハンドアノテーション済み?)
- 画角に人が適切に写っていない場合、体動センサーで判定できるものの、画像からは判定できない
- 毛布などによって被覆されている
- Autosegmentation の基準になるResNetで検出されない
- カメラ画像が欠損している
- カメラ画像にノイズが載っている

### 体動センサー測定不備による検出不可
- 画角に人は写っているが、何らかの行動を行っており、体動センサーにノイズが強く乗っている場合
- 画角に人は写っているが、人の姿勢(体動センサー)に強くテンションがかかっている場合
- 体動センサーの設置位置が、適切な領域になく、評価対象の情報(心拍 / 呼吸)が分離できない場合
- 道路の振動など、カプセル自体に揺れが含まれている場合

### センサー間の特徴の違い
- 旧型体動センサー / 新型体動センサーの違い

## 説明変数の候補について
### 前処理について
- 0中心化処理後
- 1000人分の人がいる区間のデータを使って事前調整済みのScalerを用いてrescale (センサー間の違いの解消)
    - 旧型センサー (男女 50:50の100人)
    - 新型センサー (男女 50:50の100人)
    - 新型カプセル・新型センサー (男女 10:10の20人)
- 50Hz Notchフィルター
- raw / f1 / f2 それぞれについて、新型・旧型ともに評価を行う

### 固定処理系
- [x] 自己相関係数 <= has_vibrationの領域判定の時に使っている自己相関係数(道路揺れ / 低周期の建物揺れ)
- [x]心拍呼吸信号比率(FFTベース)
- ~心拍呼吸信号比率(cwtベース)~
- [x] 東京医科歯科類似の心拍信号抽出関数 + hilbert変換後の積分値
- [x] 区間分散 <= epoch分割するタイミングの在不在判定 / 旧型のみの想定で使われている
- ~区間平均~
- [ ] ARIMA特徴量
- [x] 正規化後の異常区間率

### ML系
- テンプレート距離変動周期性微分
- AE誤差量
- TimeNet

